10 SCREEN 1:KEY OFF:RANDOMIZE TIMER
20 DIM BOOT(500),MASK1(500),SUB(500),MASK2(500),SINK(750),MASK3(750),BOMB1(100),BOMB2(100),MASK4(100),MASK5(100)
30 DIM BG1(500),BG2(500),BG3(500),BG4(500),BG5(500),BG6(500),BG7(750)
40 DIM BB1(100),BB2(500),BB3(500),BB4(500),BB5(100),BB6(100),BB7(500),BB8(500)
50 DIM DROP(3)
60 GOTO 2420
70 GOSUB 900
80 GOSUB 660
90 XS = 100:YS = 65:SS=2:SU=-2:DROP(1) = 0:DROP(2) = 0:DROP(3) = 0:SC = 0
100 XU(1) = 20:XU(2) = 80:XU(3) = 150:XU(4) = 195:XU(5) = 260:BS = 10
110 FOR I = 1 TO 5:YU(I) = INT(RND * 75)+95:VU(I) = 1:NEXT I
120 GOSUB 630
130 GOSUB 1960
140 IF TI= 0 THEN GOSUB 270
150 TI= TI+ 1:IF TI= 10 THEN TI= 0
160 GOSUB 1240:GOSUB 1300:GOSUB 1380:GOSUB 1470:GOSUB 1560:GOSUB 1650:GOSUB 2060
170 GOSUB 360
180 TIME! = TIMER
190 IF TIMER < (TIME! + .1) THEN 190
200 GOSUB 470
210 GOSUB 1280:GOSUB 2160:GOSUB 1350:GOSUB 1440:GOSUB 1530:GOSUB 1620: GOSUB 1710
220 XS = XS + SS:GOSUB 1740
230 IF XS > 278 THEN XS = 0
240 IF XS < 0 THEN XS = 277
250 GOTO 130
260 SOUND 250,1:SOUND 255,1:SOUND 280,1:SOUND 330,1:RETURN
270 FOR I=1 TO 5
280 IF UB(I) = 1 THEN 340
290 FOR J = 1 TO 5
300 IF VU(J) = 0 THEN 330
310 Z = INT(RND * 20)
320 IF Z = 5 THEN UB(I) = 1:UBX(I) = XU(J) + 20:UBY(I) = YU(J) - 10:GOTO 340
330 NEXT J
340 NEXT I
350 RETURN
360 FOR I = 1 TO 5
370 IF UB(I) = 0 THEN 450
380 IF I = 1 THEN GET (UBX(I),UBY(I))-(UBX(I)+2,UBY(I)+2),BB4
390 IF I = 2 THEN GET (UBX(I),UBY(I))-(UBX(I)+2,UBY(I)+2),BB5
400 IF I = 3 THEN GET (UBX(I),UBY(I))-(UBX(I)+2,UBY(I)+2),BB6
410 IF I = 4 THEN GET (UBX(I),UBY(I))-(UBX(I)+2,UBY(I)+2),BB7
420 IF I = 5 THEN GET (UBX(I),UBY(I))-(UBX(I)+2,UBY(I)+2),BB8
430 PUT (UBX(I),UBY(I)),MASK5,AND
440 PUT (UBX(I),UBY(I)),BOMB2,XOR
450 NEXT I
460 RETURN
470 FOR I = 0 TO 5
480 IF UB(I) = 0 THEN 560
490 IF I = 1 THEN PUT(UBX(I),UBY(I)),BB4,PSET
500 IF I = 2 THEN PUT(UBX(I),UBY(I)),BB5,PSET
510 IF I = 3 THEN PUT(UBX(I),UBY(I)),BB6,PSET
520 IF I = 4 THEN PUT(UBX(I),UBY(I)),BB7,PSET
530 IF I = 5 THEN PUT(UBX(I),UBY(I)),BB8,PSET
540 UBY(I) = UBY(I) - 2
550 IF UBY(I) < 75 THEN GOSUB 580
560 NEXT I
570 RETURN
580 IF POINT (UBX(I),UBY(I)-2) = 2 THEN GOSUB 1280:GOTO 1810
590 UB(I) = 0
600 UBX(I) = 0
610 UBY(I) = 0
620 RETURN
630 LOCATE 25,1:PRINT STRING$(40," ");
640 LOCATE 25,1:PRINT "BOMBS:";BS;"DESTROIED:";DS;"SCORE:";SC;
650 RETURN
660 FOR I = 76 TO 200 STEP 2
670 LINE (0,I)-(320,I),0,B,&HAAAA
680 LINE (0,I)-(320,I),1,B,&H5555
690 LINE (0,I+1)-(320,I+1),1,B,&HAAAA
700 LINE (0,I+1)-(320,I+1),0,B,&H5555
710 NEXT I
720 FOR I = 0 TO 320 STEP 3
730 U = INT(RND * 5)
740 LINE (I,200)-(I+3,180-U),3,BF
750 LINE (I+3,180-U)-(I+3,200),1
760 NEXT I
770 LINE (0,0)-(320,75),1,BF
780 FOR I = 0 TO 320 STEP 10
790 LINE (I,76)-(I+7,76),1
800 NEXT I
810 X(1) = 50:X(2) = 150:X(2) = 200
820 FOR I = 1 TO 3
830 FOR T = X(I) TO X(I) + 70 STEP 10
840 U1 = INT(RND * 8)
850 U2 = INT(RND * 8)
860 LINE (T,10+U1)-(T+10,30-U2),3,BF
870 NEXT T
880 NEXT I
890 RETURN
900 DRAW "BM 100,100 C2 R5D2R3U4R5U3R5D3R7D4R10U2R5D1G1D1G3L1G1L28H1L1H3U1H1U1BR10P2,2
910 GET (100,95)-(140,108),BOOT
920 LINE (100,95)-(140,108),0,BF
930 LINE (100,95)-(140,108),3,BF
940 DRAW "BM 100,100 C0 R5D2R3U4R5U3R5D3R7D4R10U2R5D1G1D1G3L1G1L28H1L1H3U1H1U1BR10P0,0
950 GET (100,95)-(140,108),MASK1
960 LINE (100,95)-(140,108),0,BF
970 DRAW "BM 100,100 C2 R2E1R10U3R3U4D4R4D3R5F1R3F1R5U1D4U1L5G1L3G1L22H1L2H1U2BR1P2,2
980 GET (99,92)-(135,105),SUB
990 LINE (99,92)-(135,105),0,BF
1000 LINE (99,92)-(135,105),3,BF
1010 DRAW "BM 100,100 C0 R2E1R10U3R3U4D4R4D3R5F1R3F1R5U1D4U1L5G1L3G1L22H1L2H1U2BR1P0,0
1020 GET (99,92)-(135,105),MASK2
1030 LINE (99,92)-(135,105),0,BF
1040 DRAW "BM 100,100 C2 TA320 R5D2R3U4R5U3R5D3R7D4R10U2R5D1G1D1G3L1G1L28H1L1H3U1H1U1BR10P2,2
1050 GET (98,100)-(131,124),SINK
1060 LINE (98,100)-(131,124),0,BF
1070 LINE (98,100)-(131,124),3,BF
1080 DRAW "BM 100,100 C0 TA320 R5D2R3U4R5U3R5D3R7D4R10U2R5D1G1D1G3L1G1L28H1L1H3U1H1U1BR10P0,0
1090 GET (98,100)-(131,124),MASK3
1100 LINE (98,100)-(131,124),0,BF
1110 DRAW "BM 100,100 C2 TA315 D4R2U4L1D4
1120 GET (97,100)-(101,105),BOMB1
1130 LINE (97,100)-(101,105),0,BF
1140 LINE (97,100)-(101,105),3,BF
1150 DRAW "BM 100,100 C0 TA315 D4R2U4L1D4
1160 GET (97,100)-(101,105),MASK4
1170 LINE (97,100)-(101,105),0,BF
1180 DRAW "BM 100,100 TA0 C2 R2L1U1D2
1190 GET (100,99)-(102,101),BOMB2
1200 LINE (100,99)-(102,101),3,BF
1210 DRAW "BM 100,100 TA0 C0 R2L1U1D2
1220 GET (100,99)-(102,101),MASK5
1230 RETURN
1240 GET (XS,YS)-(XS+40,YS+13),BG1
1250 PUT (XS,YS),MASK1,AND
1260 PUT (XS,YS),BOOT,XOR
1270 RETURN
1280 PUT (XS,YS),BG1,PSET
1290 RETURN
1300 IF VU(1) = 0 THEN 1340
1310 GET (XU(1),YU(1))-(XU(1)+36,YU(1)+13),BG2
1320 PUT (XU(1),YU(1)),MASK2,AND
1330 PUT (XU(1),YU(1)),SUB,XOR
1340 RETURN
1350 IF VU(1) = 0 THEN 1370
1360 PUT (XU(1),YU(1)),BG2,PSET
1370 RETURN
1380 IF VU(2) = 0 THEN 1430
1390 GET (XU(2),YU(2))-(XU(2)+36,YU(2)+13),BG3
1400 PUT (XU(2),YU(2)),SUB,XOR
1410 PUT (XU(2),YU(2)),MASK2,AND
1420 PUT (XU(2),YU(2)),SUB,XOR
1430 RETURN
1440 IF VU(2) = 0 THEN 1460
1450 PUT (XU(2),YU(2)),BG3,PSET
1460 RETURN
1470 IF VU(3) = 0 THEN 1520
1480 GET (XU(3),YU(3))-(XU(3)+36,YU(3)+13),BG4
1490 PUT (XU(3),YU(3)),SUB,XOR
1500 PUT (XU(3),YU(3)),MASK2,AND
1510 PUT (XU(3),YU(3)),SUB,XOR
1520 RETURN
1530 IF VU(3) = 0 THEN 1550
1540 PUT (XU(3),YU(3)),BG4,PSET
1550 RETURN
1560 IF VU(4) = 0 THEN 1610
1570 GET (XU(4),YU(4))-(XU(4)+36,YU(4)+13),BG5
1580 PUT (XU(4),YU(4)),SUB,XOR
1590 PUT (XU(4),YU(4)),MASK2,AND
1600 PUT (XU(4),YU(4)),SUB,XOR
1610 RETURN
1620 IF VU(4) = 0 THEN 1640
1630 PUT (XU(4),YU(4)),BG5,PSET
1640 RETURN
1650 IF VU(5) = 0 THEN 1700
1660 GET (XU(5),YU(5))-(XU(5)+36,YU(5)+13),BG6
1670 PUT (XU(5),YU(5)),SUB,XOR
1680 PUT (XU(5),YU(5)),MASK2,AND
1690 PUT (XU(5),YU(5)),SUB,XOR
1700 RETURN
1710 IF VU(5) = 0 THEN 1730
1720 PUT (XU(5),YU(5)),BG6,PSET
1730 RETURN
1740 FOR I = 1 TO 5
1750 XU(I) = XU(I) + SU
1760 IF XU(I) < 0 THEN XU(I) = 280:YU(I) = INT(RND * 75)+95:VU(I) = 1
1770 NEXT I
1780 RETURN
1790 GOSUB 1240:GOSUB 1300:GOSUB 1380:GOSUB 1470:GOSUB 1560:GOSUB 1650:GOSUB 2060
1800 PLAY "MBO0B64A64G64F64E64D64C64D64C64D64"
1810 PLAY "MBO1B64A64G64F64E64D64C64D64C64D64"
1820 PLAY "MBO0B64A64G64F64E64D64C64D64C64D64":GOSUB 1280
1830 FOR I = YS TO 164 STEP 2
1840 GET (XS,I)-(XS+33,I+24),BG7
1850 PUT (XS,I),MASK3,AND
1860 PUT (XS,I),SINK,XOR
1870 TIME! = TIMER
1880 IF TIMER < (TIME! + .1) THEN 1880
1890 PUT (XS,I),BG7,PSET
1900 NEXT I
1910 PUT (XS,I),MASK3,AND
1920 PUT (XS,I),SINK,XOR
1930 LOCATE 25,1:PRINT "         YOU SUNK!!! - GAME OVER        ";
1940 IF SC > HI THEN HI = SC
1950 GOTO 60
1960 K$ = INKEY$
1970 IF K$ = CHR$(27) THEN 1790
1980 IF K$ = CHR$(0) + "M" THEN SS = 2
1990 IF K$ = CHR$(0) + "K" THEN SS = -2
2000 IF K$ = CHR$(32) THEN GOSUB 2020
2010 RETURN
2020 FOR I = 1 TO 3
2030 IF DROP(I) = 0 THEN DROP(I) = 1:DX(I) = XS + 20:DY(I) = YS +15:GOSUB 260:BS=BS - 1:GOSUB 630:GOTO 2050
2040 NEXT I
2050 RETURN
2060 FOR I = 1 TO 3
2070 IF DROP(I) = 0 THEN GOTO 2140
2080 IF I = 1 THEN GET (DX(I),DY(I))-(DX(I)+5,DY(I)+7),BB1
2090 IF I = 2 THEN GET (DX(I),DY(I))-(DX(I)+5,DY(I)+7),BB2
2100 IF I = 3 THEN GET (DX(I),DY(I))-(DX(I)+5,DY(I)+7),BB3
2110 PUT (DX(I),DY(I)),MASK4,AND
2120 PUT (DX(I),DY(I)),BOMB1,XOR
2130 IF POINT(DX(I),DY(I) + 7) = 2 THEN GOSUB 2250
2140 NEXT I
2150 RETURN
2160 FOR K = 1 TO 3
2170 IF DROP(K) = 0 THEN GOTO 2230
2180 IF K = 1 THEN PUT (DX(K),DY(K)),BB1,PSET
2190 IF K = 2 THEN PUT (DX(K),DY(K)),BB2,PSET
2200 IF K = 3 THEN PUT (DX(K),DY(K)),BB3,PSET
2210 DY(K) = DY(K) + 2
2220 IF DY(K) >= 180 THEN DROP(K) = 0
2230 NEXT K
2240 RETURN
2250 FOR J = 1 TO 5
2260 IF DX(I) > XU(J) AND DX(I) < XU(J) + 30 THEN GOSUB 2290
2270 NEXT J
2280 RETURN
2290 PLAY "MBO0B64A64G64F64E64D64C64"
2300 GOSUB 2160
2310 DROP(I) = 0:BS=BS+2:DS=DS+1:SC=SC+INT(YU(J)/10):GOSUB 630
2320 FOR K = 1 TO I
2330 DY(K) = DY(K) - 2
2340 NEXT K
2350 IF J = 1 THEN GOSUB 1350:VU(J) =0
2360 IF J = 2 THEN GOSUB 1440:VU(J) = 0
2370 IF J = 3 THEN GOSUB 1530:VU(J) = 0
2380 IF J = 4 THEN GOSUB 1620:VU(J) = 0
2390 IF J = 5 THEN GOSUB 1710:VU(J) = 0
2400 RETURN
2410 SCREEN 0:COLOR 7,0:CLS:KEY ON:WIDTH 80,25:CLS:END
2420 LINE (0,0)-(320,28),3,BF
2430 FOR I = 29 TO 56 STEP 2
2440 LINE (0,I)-(320,I),3,B,&HAAAA:LINE (0,I)-(320,I),1,B,&H5555
2450 LINE (0,I+1)-(320,I+1),3,B,&H5555:LINE (0,I+1)-(320,I+1),1,B,&HAAAA
2460 NEXT I
2470 LINE (0,57)-(320,84),1,BF
2480 FOR I = 85 TO 112 STEP 2
2490 LINE (0,I)-(320,I),1,B,&HAAAA:LINE (0,I)-(320,I),2,B,&H5555
2500 LINE (0,I+1)-(320,I+1),1,B,&H5555:LINE (0,I+1)-(320,I+1),2,B,&HAAAA
2510 NEXT I
2520 LINE (0,113)-(320,140),2,BF
2530 FOR I = 141 TO 168 STEP 2
2540 LINE (0,I)-(320,I),2,B,&HAAAA:LINE (0,I)-(320,I),0,B,&H5555
2550 LINE (0,I+1)-(320,I+1),2,B,&H5555:LINE (0,I+1)-(320,I+1),0,B,&HAAAA
2560 NEXT I
2570 LINE (0,169)-(320,200),0,BF
2580 LOCATE 24,10:PRINT "GW-BASIC SUBMARINES";
2590 LOCATE 1,10:PRINT SC;
2600 LOCATE 1,30:PRINT HI;
2610 LOCATE 25,2:PRINT "PROGRAMMED BY MAARTEN! OF :) CHEERFUL";
2620 IF INKEY$ = "" THEN GOSUB 2920:GOTO 2620
2630 LOCATE 24,7:PRINT "DO YOU NEED INSTRUCTIONS?";
2640 LOCATE 25,1:PRINT STRING$(40," ");
2650 LOCATE 25,14:PRINT "ESC TO QUIT.";
2660 K$ = INKEY$
2670 IF K$ = "y" OR K$ = "Y" THEN 2720
2680 IF K$ = "n" OR K$ = "N" THEN CLS:GOTO 2900
2690 IF K$ = CHR$(27) THEN 2410
2700 GOSUB 2920
2710 GOTO 2660
2720 CLS:SCREEN 0:WIDTH 80,25
2730 LOCATE 3,20:PRINT "In this little game I made (when I was"
2740 LOCATE 4,20:PRINT "supposed to study for my final exam =] )"
2750 LOCATE 5,20:PRINT "you must destroy the submarines on the"
2760 LOCATE 6,20:PRINT "screen by dropping mines in the sea with"
2770 LOCATE 7,20: PRINT "the SPACEBAR. But watch out!! The subs"
2780 LOCATE 8,20: PRINT "will fire mines at you too. Try to"
2790 LOCATE 9,20: PRINT "avoid them by moving with the cursor"
2800 LOCATE 10,20: PRINT "keys. For every sub you destroy you'll"
2810 LOCATE 11,20: PRINT "be awarded with 2 mines. The deeper the"
2820 LOCATE 12,20: PRINT "subs are the more points you get."
2830 LOCATE 14,30:PRINT "GOOD LUCK!"
2840 LOCATE 18,12: PRINT "This is a game by Maarten! of :) Cheerful Software in 2001"
2850 LOCATE 19,12: PRINT "Don't forget to visit HTTP://Welcome.To/Cheerful"
2860 LOCATE 20,12: PRINT "Please send some feedback to Maarten_Rules@Cheerful.com"
2870 LOCATE 25,1:PRINT "Press any key when you've read this."
2880 IF INKEY$ = "" THEN 2880
2890 SCREEN 1:KEY OFF:GOTO 2420
2900 SCREEN 1:KEY OFF
2910 GOTO 70
2920 READ MU$
2930 IF MU$ = "*" THEN RESTORE:MU$ = "p2"
2940 PLAY "mbo0t75" + MU$
2950 IF PLAY(0) > 2 THEN 2950
2960 RETURN
2970 DATA c32,c32,c32,c32,p4,c32,c32,c32,c32,d32,d32,d32,d32,*
